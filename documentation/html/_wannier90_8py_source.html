<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.8"/>
<title>DFT_KIT: calculator/Wannier90.py Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DFT_KIT
   </div>
   <div id="projectbrief">DFT tools collection</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.8 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_46ec98a0eaec3dba456c3e63c7772753.html">calculator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Wannier90.py</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_wannier90_8py.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno"><a class="line" href="namespace_d_f_t___k_i_t_1_1calculator_1_1_wannier90.html">    1</a></span>&#160;<span class="comment"># Density_Function_Theory - KIT  v1.0.0 </span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"># August 2014</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"># Class for the object atom to construct the lattice and basis atoms</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"># general procedure for running wannier90</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">#1) Run Q-Espresso as usual for scf/nscf with k points generated by kmesh.pl (MP grid). </span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">#2) run wannier90 -pp seedname to generate files to indicate necessary quantities to be computed. </span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">#3) run pw2wannier90 to calculate the quantities (input file) </span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">#4) back to wannier90 to evaluate the Wannier function and hamiltonian.</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="keyword">import</span> os</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="keyword">import</span> shutil</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">import</span> pickle</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">import</span> string</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="keyword">import</span> numpy <span class="keyword">as</span> np</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="keyword">import</span> sys</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="keyword">import</span> string</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="keyword">from</span> <a class="code" href="namespace_d_f_t___k_i_t_1_1core.html">DFT_KIT.core</a> <span class="keyword">import</span> general_tool</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">from</span> <a class="code" href="namespace_d_f_t___k_i_t_1_1core.html">DFT_KIT.core</a> <span class="keyword">import</span> env_parm</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">from</span> <a class="code" href="namespace_d_f_t___k_i_t_1_1core.html">DFT_KIT.core</a> <span class="keyword">import</span> calculator</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">#for *.win file</span></div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="namespace_d_f_t___k_i_t_1_1calculator_1_1_wannier90.html#ad9950007869589842f2abe7f2c75b877">   24</a></span>&#160;QES_wannier90_flags=[<span class="stringliteral">&#39;num_wann&#39;</span>,<span class="stringliteral">&#39;num_bands&#39;</span>,<span class="stringliteral">&#39;unit_cell_cart&#39;</span>,<span class="stringliteral">&#39;gamma_only&#39;</span>,<span class="stringliteral">&#39;spinor&#39;</span>,<span class="stringliteral">&#39;shell_list&#39;</span>,<span class="stringliteral">&#39;search_shells&#39;</span>,<span class="stringliteral">&#39;kmesh_tol&#39;</span>,<span class="stringliteral">&#39;postproc_setup&#39;</span>,<span class="stringliteral">&#39;exclude_bands&#39;</span>,<span class="stringliteral">&#39;restart&#39;</span>,<span class="stringliteral">&#39;iprint&#39;</span>,<span class="stringliteral">&#39;length_unit&#39;</span>,<span class="stringliteral">&#39;wvfn_formatted&#39;</span>,</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                     <span class="stringliteral">&#39;spin&#39;</span>,<span class="stringliteral">&#39;devel_flag&#39;</span>,<span class="stringliteral">&#39;timing_level&#39;</span>,<span class="stringliteral">&#39;optimisation&#39;</span>,<span class="stringliteral">&#39;translate_home_cell&#39;</span>,<span class="stringliteral">&#39;write_xyz&#39;</span>,<span class="stringliteral">&#39;write_vdw_data&#39;</span>,<span class="stringliteral">&#39;write_hr_diag&#39;</span>,<span class="stringliteral">&#39;dis_win_min&#39;</span>,<span class="stringliteral">&#39;dis_win_max&#39;</span>,<span class="stringliteral">&#39;dis_froz_min&#39;</span>,<span class="stringliteral">&#39;dis_froz_max&#39;</span>,<span class="stringliteral">&#39;dis_num_iter&#39;</span>,<span class="stringliteral">&#39;dis_mix_ratio&#39;</span>,<span class="stringliteral">&#39;dis_conv_tol&#39;</span>,</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                     <span class="stringliteral">&#39;dis_conv_window&#39;</span>,<span class="stringliteral">&#39;num_iter&#39;</span>,<span class="stringliteral">&#39;num_cg_steps&#39;</span>,<span class="stringliteral">&#39;conv_window&#39;</span>,<span class="stringliteral">&#39;conv_tol&#39;</span>,<span class="stringliteral">&#39;conv_noise_amp&#39;</span>,<span class="stringliteral">&#39;conv_noise_num&#39;</span>,<span class="stringliteral">&#39;num_dump_cycles&#39;</span>,<span class="stringliteral">&#39;num_print_cycles&#39;</span>,<span class="stringliteral">&#39;write_r2mn&#39;</span>,<span class="stringliteral">&#39;guiding_center&#39;</span>,<span class="stringliteral">&#39;num_guide_cycles&#39;</span>,<span class="stringliteral">&#39;num_to_guide_iter&#39;</span>,<span class="stringliteral">&#39;trial_step&#39;</span>,</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                     <span class="stringliteral">&#39;fixed_step&#39;</span>,<span class="stringliteral">&#39;use_bloch_phases&#39;</span>,<span class="stringliteral">&#39;wannier_plot&#39;</span>,<span class="stringliteral">&#39;wannier_plot_list&#39;</span>,<span class="stringliteral">&#39;wannier_plot_supercell&#39;</span>,<span class="stringliteral">&#39;wannier_plot_format&#39;</span>,<span class="stringliteral">&#39;wannier_plot_mode&#39;</span>,<span class="stringliteral">&#39;wannier_plot_radius&#39;</span>,<span class="stringliteral">&#39;bands_plot&#39;</span>,<span class="stringliteral">&#39;kpoint_path&#39;</span>,<span class="stringliteral">&#39;bands_num_points&#39;</span>,<span class="stringliteral">&#39;bands_plot_format&#39;</span>,<span class="stringliteral">&#39;bands_plot_project&#39;</span>,</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                     <span class="stringliteral">&#39;bands_plot_mode&#39;</span>,<span class="stringliteral">&#39;bands_plot_dim&#39;</span>,<span class="stringliteral">&#39;fermi_surface_plot&#39;</span>,<span class="stringliteral">&#39;fermi_surface_num_points&#39;</span>,<span class="stringliteral">&#39;fermi_energy&#39;</span>,<span class="stringliteral">&#39;fermi_energy_min&#39;</span>,<span class="stringliteral">&#39;fermi_energy_max&#39;</span>,<span class="stringliteral">&#39;fermi_energy_step&#39;</span>,<span class="stringliteral">&#39;fermi_surface_plot_format&#39;</span>,<span class="stringliteral">&#39;hr_plot&#39;</span>,<span class="stringliteral">&#39;hr_cutoff&#39;</span>,<span class="stringliteral">&#39;dist_cutoff&#39;</span>,<span class="stringliteral">&#39;dist_cutoff_mode&#39;</span>,</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                     <span class="stringliteral">&#39;translation_center_frac&#39;</span>,<span class="stringliteral">&#39;transport&#39;</span>,<span class="stringliteral">&#39;transport_mode&#39;</span>,<span class="stringliteral">&#39;tran_win_min&#39;</span>,<span class="stringliteral">&#39;tran_win_max&#39;</span>,<span class="stringliteral">&#39;tran_energy_step&#39;</span>,<span class="stringliteral">&#39;fermi_energy&#39;</span>,<span class="stringliteral">&#39;tran_num_bb&#39;</span>,<span class="stringliteral">&#39;tran_num_ll&#39;</span>,<span class="stringliteral">&#39;tran_num_rr&#39;</span>,<span class="stringliteral">&#39;tran_num_cc&#39;</span>,<span class="stringliteral">&#39;tran_num_lc&#39;</span>,<span class="stringliteral">&#39;tran_num_cr&#39;</span>,<span class="stringliteral">&#39;tran_num_cell_ll&#39;</span>,<span class="stringliteral">&#39;tran_num_cell_rr&#39;</span>,<span class="stringliteral">&#39;tran_num_bandc&#39;</span>,</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                     <span class="stringliteral">&#39;tran_write_ht&#39;</span>,<span class="stringliteral">&#39;tran_read_ht&#39;</span>,<span class="stringliteral">&#39;tran_use_same_lead&#39;</span>,<span class="stringliteral">&#39;tran_group_threshold&#39;</span>,<span class="stringliteral">&#39;hr_cutoff&#39;</span>,<span class="stringliteral">&#39;dist_cutoff&#39;</span>,<span class="stringliteral">&#39;dist_cutoff_mode&#39;</span>,<span class="stringliteral">&#39;one_dim_axis&#39;</span>,<span class="stringliteral">&#39;translation_center_frac&#39;</span>]</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;</div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html">   32</a></span>&#160;<span class="keyword">class </span><a class="code" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html">calculator_Wannier90</a>(calculator.calculator):</div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a74a7bbb9cae9f82ecbca0cc40980d10e">   33</a></span>&#160;    <span class="keyword">def </span><a class="code" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a74a7bbb9cae9f82ecbca0cc40980d10e">__init__</a>(self,postprocess,dft_job,crystal,kgrid,scheme=0,**parms):</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;        calculator.calculator.__init__(self,postprocess,dft_job,crystal,kgrid,**parms)</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;        self.<a class="code" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a16a225c3f0ebca12e4bb8299321d425a">apply_scheme</a>(scheme)</div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a673a29eac1991c2660c4ddf30331d453">   36</a></span>&#160;        self.<a class="code" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a673a29eac1991c2660c4ddf30331d453">projections</a>=[]</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        </div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a7b4a65524bb0a912f03d3fdbe9813bf7">   38</a></span>&#160;    <span class="keyword">def </span><a class="code" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a7b4a65524bb0a912f03d3fdbe9813bf7">add_projection</a>(self,proj):</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        self.projections.append(proj)</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        </div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a16a225c3f0ebca12e4bb8299321d425a">   41</a></span>&#160;    <span class="keyword">def </span><a class="code" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a16a225c3f0ebca12e4bb8299321d425a">apply_scheme</a>(self,scheme):</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        self.set_parm(<span class="stringliteral">&#39;ibrav&#39;</span>,<span class="stringliteral">&#39;0&#39;</span>)</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <span class="keywordflow">if</span> scheme==0:</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;            <span class="comment"># general scf for insulator</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;            self.set_parm(<span class="stringliteral">&#39;iprint&#39;</span>,<span class="stringliteral">&#39;2&#39;</span>)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;            self.set_parm(<span class="stringliteral">&#39;num_dump_cycles&#39;</span>,<span class="stringliteral">&#39;10&#39;</span>)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;            self.set_parm(<span class="stringliteral">&#39;num_print_cycles&#39;</span>,<span class="stringliteral">&#39;10&#39;</span>)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;            self.set_parm(<span class="stringliteral">&#39;length_unit&#39;</span>,<span class="stringliteral">&#39;Ang&#39;</span>)</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#aaff180b1ad9f56ce24d2063931eabcc2">   50</a></span>&#160;    <span class="keyword">def </span><a class="code" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#aaff180b1ad9f56ce24d2063931eabcc2">run_main</a>(self):</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">pass</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a8a6d0629564467fa5595aa75a9857bbd">   52</a></span>&#160;    <span class="keyword">def </span><a class="code" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a8a6d0629564467fa5595aa75a9857bbd">generate_files</a>(self):</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        <span class="comment">#control section</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        f_=open(<span class="stringliteral">&#39;wannier90.win&#39;</span>,<span class="stringliteral">&#39;w&#39;</span>)</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">for</span> ind_key <span class="keywordflow">in</span> self.parms:</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            <span class="keywordflow">if</span> ind_key <span class="keywordflow">in</span> QES_wannier90_flags:</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                f_.write(ind_key+<span class="stringliteral">&#39; = &#39;</span> + self.parms[ind_key]+<span class="stringliteral">&#39; \n&#39;</span>)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        f_.write(<span class="stringliteral">&#39;\n&#39;</span>)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        f_.write(<span class="stringliteral">&#39;begin projections\n&#39;</span>)</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="keywordflow">for</span> proj <span class="keywordflow">in</span> self.projections:</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;            f_.write(<span class="stringliteral">&#39; &#39;</span>+proj+<span class="stringliteral">&#39;\n&#39;</span>)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        f_.write(<span class="stringliteral">&#39;end projections\n\n&#39;</span>)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        f_.write(<span class="stringliteral">&#39;begin unit_cell_cart\nAng\n&#39;</span>)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        f_.write(<span class="stringliteral">&#39; &#39;</span>+general_tool.vec_to_str(self.crystal.get_prim_vec(0)) +<span class="stringliteral">&#39;\n&#39;</span>)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        f_.write(<span class="stringliteral">&#39; &#39;</span>+general_tool.vec_to_str(self.crystal.get_prim_vec(1)) +<span class="stringliteral">&#39;\n&#39;</span>)</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        f_.write(<span class="stringliteral">&#39; &#39;</span>+general_tool.vec_to_str(self.crystal.get_prim_vec(2)) +<span class="stringliteral">&#39;\n&#39;</span>)</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        f_.write(<span class="stringliteral">&#39;end unit_cell_cart\n\n&#39;</span>)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        f_.write(<span class="stringliteral">&#39;begin atoms_cart\nAng\n&#39;</span>)</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">for</span> ind, group <span class="keywordflow">in</span> enumerate(self.crystal.basis_atom_groups.keys()):</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            <span class="keywordflow">for</span> atom <span class="keywordflow">in</span> self.crystal.basis_atom_groups[group]:</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                f_.write(<span class="stringliteral">&#39; &#39;</span>+ group + <span class="stringliteral">&#39; &#39;</span> +general_tool.vec_to_str(atom.get_position())+<span class="stringliteral">&#39;\n&#39;</span>)</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        f_.write(<span class="stringliteral">&#39;end atoms_cart\n\n&#39;</span>)</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        f_.write(<span class="stringliteral">&#39;mp_grid &#39;</span> + general_tool.vec_to_str(self.kgrid.kgrid) + <span class="stringliteral">&#39;\n\n&#39;</span>)</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        tmp_list=self.kgrid.generate_kgrid(<span class="keyword">False</span>)</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        f_.write(<span class="stringliteral">&#39;begin kpoints\n&#39;</span>)</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="keywordflow">for</span> kpt <span class="keywordflow">in</span> tmp_list:</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            f_.write(<span class="stringliteral">&#39; &#39;</span> + general_tool.vec_to_str(kpt)+<span class="stringliteral">&#39;\n&#39;</span>)</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        f_.write(<span class="stringliteral">&#39;end kpoints\n&#39;</span>)</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        f_.close()</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        </div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#af791da89001cc173855be20c09097166">   88</a></span>&#160;    <span class="keyword">def </span><a class="code" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#af791da89001cc173855be20c09097166">run_wannier</a>(self):</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">pass</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    </div>
<div class="line"><a name="l00091"></a><span class="lineno"><a class="line" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a3015ae1b54f5fb07f10d4574f2a528db">   91</a></span>&#160;    <span class="keyword">def </span><a class="code" href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a3015ae1b54f5fb07f10d4574f2a528db">read_hamiltonian</a>(self):</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        output={<span class="stringliteral">&#39;connectionR&#39;</span>:<span class="keywordtype">None</span>,<span class="stringliteral">&#39;Hamiltonian&#39;</span>:<span class="keywordtype">None</span>}</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        f_=open(<span class="stringliteral">&#39;*.hr&#39;</span>,<span class="stringliteral">&#39;</span><span class="stringliteral">r&#39;)</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="stringliteral">        f_.readline()</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="stringliteral">        num_wann=int(f_.readline())</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="stringliteral">        nrpts=int(f_.readline())</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="stringliteral">        </span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="stringliteral">        num_lines=int((float(nrpts)-1.0)/float(15.0))+1</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="stringliteral">        degeneracy=[]</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="stringliteral">        </span><span class="keywordflow">for</span> ind <span class="keywordflow">in</span> range(0,num_lines):</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            tmp=f_.readline().split()</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            <span class="keywordflow">for</span> itm <span class="keywordflow">in</span> tmp:</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                degeneracy.append(int(itm))</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        tot_lines=num_wann*num_wann*nrpts</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="comment">#start to analyze the lines</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div>
<div class="ttc" id="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90_html_a8a6d0629564467fa5595aa75a9857bbd"><div class="ttname"><a href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a8a6d0629564467fa5595aa75a9857bbd">DFT_KIT.calculator.Wannier90.calculator_Wannier90.generate_files</a></div><div class="ttdeci">def generate_files</div><div class="ttdef"><b>Definition:</b> <a href="_wannier90_8py_source.html#l00052">Wannier90.py:52</a></div></div>
<div class="ttc" id="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90_html_af791da89001cc173855be20c09097166"><div class="ttname"><a href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#af791da89001cc173855be20c09097166">DFT_KIT.calculator.Wannier90.calculator_Wannier90.run_wannier</a></div><div class="ttdeci">def run_wannier</div><div class="ttdef"><b>Definition:</b> <a href="_wannier90_8py_source.html#l00088">Wannier90.py:88</a></div></div>
<div class="ttc" id="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90_html_a74a7bbb9cae9f82ecbca0cc40980d10e"><div class="ttname"><a href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a74a7bbb9cae9f82ecbca0cc40980d10e">DFT_KIT.calculator.Wannier90.calculator_Wannier90.__init__</a></div><div class="ttdeci">def __init__</div><div class="ttdef"><b>Definition:</b> <a href="_wannier90_8py_source.html#l00033">Wannier90.py:33</a></div></div>
<div class="ttc" id="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90_html_a3015ae1b54f5fb07f10d4574f2a528db"><div class="ttname"><a href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a3015ae1b54f5fb07f10d4574f2a528db">DFT_KIT.calculator.Wannier90.calculator_Wannier90.read_hamiltonian</a></div><div class="ttdeci">def read_hamiltonian</div><div class="ttdef"><b>Definition:</b> <a href="_wannier90_8py_source.html#l00091">Wannier90.py:91</a></div></div>
<div class="ttc" id="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90_html_a16a225c3f0ebca12e4bb8299321d425a"><div class="ttname"><a href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a16a225c3f0ebca12e4bb8299321d425a">DFT_KIT.calculator.Wannier90.calculator_Wannier90.apply_scheme</a></div><div class="ttdeci">def apply_scheme</div><div class="ttdef"><b>Definition:</b> <a href="_wannier90_8py_source.html#l00041">Wannier90.py:41</a></div></div>
<div class="ttc" id="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90_html_a7b4a65524bb0a912f03d3fdbe9813bf7"><div class="ttname"><a href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a7b4a65524bb0a912f03d3fdbe9813bf7">DFT_KIT.calculator.Wannier90.calculator_Wannier90.add_projection</a></div><div class="ttdeci">def add_projection</div><div class="ttdef"><b>Definition:</b> <a href="_wannier90_8py_source.html#l00038">Wannier90.py:38</a></div></div>
<div class="ttc" id="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90_html"><div class="ttname"><a href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html">DFT_KIT.calculator.Wannier90.calculator_Wannier90</a></div><div class="ttdef"><b>Definition:</b> <a href="_wannier90_8py_source.html#l00032">Wannier90.py:32</a></div></div>
<div class="ttc" id="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90_html_aaff180b1ad9f56ce24d2063931eabcc2"><div class="ttname"><a href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#aaff180b1ad9f56ce24d2063931eabcc2">DFT_KIT.calculator.Wannier90.calculator_Wannier90.run_main</a></div><div class="ttdeci">def run_main</div><div class="ttdef"><b>Definition:</b> <a href="_wannier90_8py_source.html#l00050">Wannier90.py:50</a></div></div>
<div class="ttc" id="namespace_d_f_t___k_i_t_1_1core_html"><div class="ttname"><a href="namespace_d_f_t___k_i_t_1_1core.html">DFT_KIT.core</a></div><div class="ttdef"><b>Definition:</b> <a href="core_2____init_____8py_source.html#l00001">__init__.py:1</a></div></div>
<div class="ttc" id="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90_html_a673a29eac1991c2660c4ddf30331d453"><div class="ttname"><a href="class_d_f_t___k_i_t_1_1calculator_1_1_wannier90_1_1calculator___wannier90.html#a673a29eac1991c2660c4ddf30331d453">DFT_KIT.calculator.Wannier90.calculator_Wannier90.projections</a></div><div class="ttdeci">projections</div><div class="ttdef"><b>Definition:</b> <a href="_wannier90_8py_source.html#l00036">Wannier90.py:36</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 31 2014 22:03:11 for DFT_KIT by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.8
</small></address>
</body>
</html>
